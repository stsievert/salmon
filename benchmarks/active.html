<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Active sampling &mdash; Salmon v1.0.0rc2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/autodoc_pydantic.css" type="text/css" />
      <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adaptive algorithms" href="../adaptive.html" />
    <link rel="prev" title="Concurrent Users" href="server.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #494646" >
            <a href="../index.html">
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../init.html">Experiment initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samplers.html">Sampler configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring.html">Experiment monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../offline.html">Generating embeddings offline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Benchmarks</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="server.html">Concurrent Users</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Active sampling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#baseline">Baseline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#embedding-quality">Embedding quality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#number-of-targets">Number of targets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">Embedding quality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#response-rate">Response rate</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithm Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../adaptive.html">Adaptive algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers.html">Developing algorithms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #494646" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Salmon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Active sampling</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/stsievert/salmon/blob/master/docs/source/benchmarks/active.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="active-sampling">
<span id="experiments"></span><h1>Active sampling<a class="headerlink" href="#active-sampling" title="Permalink to this heading"></a></h1>
<p>Experimentalists often ask <strong>“how many responses should I collect with
Mechanical Turk?”</strong> It’d be nice to obtain high quality embeddings with few
human responses, both to reduce expenses and to ask informative questions for
humans.</p>
<p>Active sampling decides which questions to ask about, instead of asking
random questions. This can mean that higher accuracies are reached sooner, or
that less human responses are required to reach a particular accuracy. This
might enable you to ask about more items.</p>
<p>Active sampling algorithms are difficult in this “triplet embedding” context,
especially when in the crowdsourcing setting. <strong>However, Salmon enables good
performance of active sampling algorithms in crowdsourcing settings.</strong>
Specifically, there is evidence that Salmon provides the following features:</p>
<ol class="arabic simple">
<li><p>Salmon’s active sampling works well for any (practical) number of targets
<span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p>Random sampling requires about <strong>2–3× more human responses</strong> than Salmon’s
active sampling.</p></li>
<li><p>Even if <strong>responses are received very quickly,</strong> Salmon’s active sampling
(almost always) performs no worse than random sampling.</p></li>
</ol>
<p>Simulations have been run for each of these points. To show these points, let’s
first walk through the experimental setup before detailing how Salmon’s active
sampling performs when compared with previous work. <a class="footnote-reference brackets" href="#id16" id="id1">2</a> Then, let’s
investigate how changing the number of targets <span class="math notranslate nohighlight">\(n\)</span> and the response rate
affect the embeddings.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>All results on this page are for a specific dataset with simulated human
responses. Other papers provide evidence of active gains; <a class="footnote-reference brackets" href="#id15" id="id2">1</a> however, they
are more moderate than the results here.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Generally, the number of responses required to reach a certain embedding
quality scales like <span class="math notranslate nohighlight">\(nd\log_2(n)\)</span>.  <a class="footnote-reference brackets" href="#id17" id="id3">3</a> <a class="footnote-reference brackets" href="#id18" id="id4">4</a>
For more detail, see the FAQ “<a class="reference internal" href="../faq.html#faq-n-responses"><span class="std std-ref">How many responses will be needed?</span></a>.”</p>
</div>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading"></a></h2>
<p>To illustrate the difference between random and active sampling, let’s run some
experiments with the “alien eggs” dataset.  For <span class="math notranslate nohighlight">\(n=30\)</span> objects, that
dataset looks like the following:</p>
<a class="reference internal image-reference" href="../_images/alien-eggs.png"><img alt="../_images/alien-eggs.png" class="align-center" src="../_images/alien-eggs.png" style="width: 100%;" /></a>
<p>This dataset is characterized by one parameter, the “smoothness” of each egg,
so they have a 1D embedding. However, let’s embed into <span class="math notranslate nohighlight">\(d=2\)</span> dimensions
to simulate a mistake and to mirror prior work. <a class="footnote-reference brackets" href="#id16" id="id5">2</a> This page will be
concerned with the data scientist workflow, and every experiment below will use
the same workflow a data scientists would:</p>
<ol class="arabic simple">
<li><p>Launch Salmon.</p></li>
<li><p>Simulate human users. <a class="footnote-reference brackets" href="#noise" id="id6">8</a></p></li>
<li><p>Download the human responses from Salmon</p></li>
<li><p>Generate the embedding offline.</p></li>
</ol>
<p>Every graph shows points with this data flow. Each point shown only changes the
number of responses available or the sampling method used. <a class="footnote-reference brackets" href="#shuffle" id="id7">5</a> Unless
explicitly mentioned, let’s compare random and active
sampling with these <code class="docutils literal notranslate"><span class="pre">init.yaml</span></code> configurations:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">d</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<span class="nt">samplers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">ARR</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">random_state</span><span class="p">:</span><span class="w"> </span><span class="nv">42</span><span class="p p-Indicator">}</span><span class="w">  </span><span class="c1"># active or adaptive sampling</span><span class="w"></span>
<span class="w">  </span><span class="nt">Random</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span><span class="w">  </span><span class="c1"># random sampling</span><span class="w"></span>
</pre></div>
</div>
<p>The “ARR” stands for “asynchronous round robin” and creates an instance of
<a class="reference internal" href="../generated/salmon.triplets.samplers.ARR.html#salmon.triplets.samplers.ARR" title="salmon.triplets.samplers.ARR"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARR</span></code></a>. For this class, the query head is
randomly chosen, and then for each head, the best comparison items are ranked
by some measure (information gain by default).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page shows results of experiments run with Salmon.
For complete details, see <a class="reference external" href="https://github.com/stsievert/salmon-experiments">https://github.com/stsievert/salmon-experiments</a></p>
</div>
</section>
<section id="baseline">
<span id="exp-baseline"></span><h2>Baseline<a class="headerlink" href="#baseline" title="Permalink to this heading"></a></h2>
<p>First, let’s run a basic experiment, one that will very closely mirror prior
work: <a class="footnote-reference brackets" href="#id16" id="id8">2</a> let’s take the <span class="math notranslate nohighlight">\(n= 30\)</span> objects above and embed them into
<span class="math notranslate nohighlight">\(d=2\)</span> dimensions. To mirror their setup, let’s develop a noise model from
their collected responses and submit responses at the same time as their
responses.  Let’s do this many times, and generate a graph of how many
responses are required to reach a particular accuracy:</p>
<a class="reference internal image-reference" href="../_images/next.png"><img alt="../_images/next.png" class="align-center" src="../_images/next.png" style="width: 100%;" /></a>
<p>This graph uses the same test set as the NEXT paper, which (mis)defines
“nearest neighbor accuracy” as “is the true nearest neighbor one of the three
closest objects?” <a class="footnote-reference brackets" href="#id16" id="id9">2</a> (the reason for the <code class="docutils literal notranslate"><span class="pre">*</span></code> in the title). <a class="footnote-reference brackets" href="#accuracy" id="id10">7</a></p>
<section id="embedding-quality">
<h3>Embedding quality<a class="headerlink" href="#embedding-quality" title="Permalink to this heading"></a></h3>
<p>Experimentalist often cares about the underlying structure more than the
accuracy. To start, let’s assume that there’s no clear relationship between
items. Then, this visualization is most appropriate for the embeddings of
particular accuracies:</p>
<a class="reference internal image-reference" href="../_images/embeddings-n=30-colorless.svg"><img alt="../_images/embeddings-n=30-colorless.svg" class="align-center" src="../_images/embeddings-n=30-colorless.svg" width="90%" /></a>
<p>These embeddings are remarkably simple, and have a clear and known
relationship. Because of that, let’s show the embeddings with colors from now
on:</p>
<a class="reference internal image-reference" href="../_images/embeddings-n=30.svg"><img alt="../_images/embeddings-n=30.svg" class="align-center" src="../_images/embeddings-n=30.svg" width="95%" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only relative distances matter in these embeddings. It doesn’t matter how
the embedding is rotated, or how the axes are scaled.</p>
</div>
</section>
</section>
<section id="number-of-targets">
<h2>Number of targets<a class="headerlink" href="#number-of-targets" title="Permalink to this heading"></a></h2>
<p>Users of Salmon frequently have a variable number of target items. For example,
they might be asking about colors – a continuous space, so they can easily
change the “number of targets.” So, <strong>how does the number of targets influence
embedding quality?</strong></p>
<p>To examine that, let’s run the same experiment above, but with 30, 90, 180 and
300 “alien eggs.” Here’s the number of responses required to reach a particular
accuracy to <em>simulated</em> human responses:</p>
<figure class="align-center" id="id20">
<a class="reference internal image-reference" href="../_images/N-accuracy.png"><img alt="../_images/N-accuracy.png" src="../_images/N-accuracy.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">The accuracy of simulated human responses for various number of responses.
The shaded region represents the 25–75% percentile among 10 runs, and the
solid line represents the median. The y-axis labels are shared with all
plots.</span><a class="headerlink" href="#id20" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="id11">
<h3>Embedding quality<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<p>Here’s the underlying embeddings for <span class="math notranslate nohighlight">\(n = 180\)</span> for various accuracy
levels on <em>simulated</em> human responses:</p>
<a class="reference internal image-reference" href="../_images/embeddings-n=180.svg"><img alt="../_images/embeddings-n=180.svg" class="align-center" src="../_images/embeddings-n=180.svg" width="100%" /></a>
<p>“Test accuracy: 80%” means “80% accurate on simulated human responses not used
for training.” The local accuracy gets much better as accuracy increases. To
visualize the structure of the underlying embedding, let’s look at the
<strong>average items closer than the true nearest neighbor</strong>. The smaller this value
is, the smoother the color gradient is above.</p>
<figure class="align-center" id="id21">
<a class="reference internal image-reference" href="../_images/N-true-NN-dist.png"><img alt="../_images/N-true-NN-dist.png" src="../_images/N-true-NN-dist.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">The average number of items closer than the true nearest neighbor. The upper
limit on the y-axis represents a very moderately accurate embedding,
slightly worse than the 80% accurate embedding above. The shaded
region/solid line has the same meaning as above, the interquartile range and
median.</span><a class="headerlink" href="#id21" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>If the embedding were a 1D manifold but not quite perfect, <a class="footnote-reference brackets" href="#perfect" id="id12">9</a> the
value on this plot would be 0.5. As with accuracy, there’s a clear advantage to
active sampling – active sampling requires a lot fewer responses to obtain a
high quality embedding in this simulation.</p>
</section>
</section>
<section id="response-rate">
<h2>Response rate<a class="headerlink" href="#response-rate" title="Permalink to this heading"></a></h2>
<p>One detail has been swept under the rug: the rate at which Salmon received
responses. There would be no gain from adaptive algorithms if all 10,000
responses were received in 1 second. In fact, the response rate above is
variable:</p>
<a class="reference internal image-reference" href="../_images/dashboard-rate.png"><img alt="../_images/dashboard-rate.png" class="align-center" src="../_images/dashboard-rate.png" style="width: 75%;" /></a>
<p>Here’s a summary of the server side timings:</p>
<a class="reference internal image-reference" href="../_images/dashboard-server-side.png"><img alt="../_images/dashboard-server-side.png" class="align-center" src="../_images/dashboard-server-side.png" style="width: 75%;" /></a>
<p><strong>How does this variable response rate affect adaptive gains?</strong> Let’s run the
same data flow as above, but with a constant response rate and (functionally)
Salmon v0.6.0. In this experiment, the number of users varies between 1
concurrent user to 10 concurrent users with a mean response time of 1 second.
Here’s the performance we see for <span class="math notranslate nohighlight">\(n=30\)</span> alien eggs (the same setup as in
<a class="reference internal" href="#exp-baseline"><span class="std std-ref">Baseline</span></a>).</p>
<a class="reference internal image-reference" href="../_images/accuracy.png"><img alt="../_images/accuracy.png" class="align-center" src="../_images/accuracy.png" style="width: 100%;" /></a>
<p>This graph shows two measures: accuracy on a set of test human responses (left)
and responses that are 100% accurate on the ground truth dataset (right). The
graph on the right is a measure of quality on the underlying embedding. The
graph on the left shows that that this quality is reflected in hold-out
performance on human responses.</p>
<p>These experiments provide evidence that the adaptive sampling above works well
in crowdsourcing settings. Additionally, they provide evidence that Salmon’s
adaptive sampling does not perform worse than random sampling.</p>
<p>This measure provides evidence that Salmon’s active sampling approach
outperforms random sampling. If true, this is an improvement over existing
software to deploy triplet queries to crowdsourced audiences: in NEXT’s
introduction paper, <a class="footnote-reference brackets" href="#id16" id="id13">2</a> the authors found “no evidence for gains from adaptive
sampling” for (nearly) the same problem. <a class="footnote-reference brackets" href="#same" id="id14">6</a></p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>“Active Perceptual Similarity Modeling with Auxiliary Information” by E.
Heim, M. Berger, and L. Seversky, and M. Hauskrecht. 2015.
<a class="reference external" href="https://arxiv.org/pdf/1511.02254.pdf">https://arxiv.org/pdf/1511.02254.pdf</a></p>
</dd>
<dt class="label" id="id16"><span class="brackets">2</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id5">2</a>,<a href="#id8">3</a>,<a href="#id9">4</a>,<a href="#id13">5</a>,<a href="#id19">6</a>)</span></dt>
<dd><p>“NEXT: A System for Real-World Development, Evaluation, and Application
of Active Learning” by K. Jamieson, L. Jain, C. Fernandez, N. Glattard
and R. Nowak. 2017.
<a class="reference external" href="http://papers.nips.cc/paper/5868-next-a-system-for-real-world-development-evaluation-and-application-of-active-learning.pdf">http://papers.nips.cc/paper/5868-next-a-system-for-real-world-development-evaluation-and-application-of-active-learning.pdf</a></p>
</dd>
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>“Finite Sample Prediction and Recovery Bounds for Ordinal Embedding.”
Jain, Jamieson, &amp; Nowak, (2016).
<a class="reference external" href="https://papers.nips.cc/paper/2016/file/4e0d67e54ad6626e957d15b08ae128a6-Paper.pdf">https://papers.nips.cc/paper/2016/file/4e0d67e54ad6626e957d15b08ae128a6-Paper.pdf</a></p>
</dd>
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>“Low-dimensional embedding using adaptively selected ordinal data.”
Jamieson, Nowak (2011).
<a class="reference external" href="https://homes.cs.washington.edu/~jamieson/resources/activeMDS.pdf">https://homes.cs.washington.edu/~jamieson/resources/activeMDS.pdf</a></p>
</dd>
</dl>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="shuffle"><span class="brackets"><a class="fn-backref" href="#id7">5</a></span></dt>
<dd><p>For random sampling, the order is also shuffled (not the case for active).</p>
</dd>
<dt class="label" id="same"><span class="brackets"><a class="fn-backref" href="#id14">6</a></span></dt>
<dd><p>Both experiment use <span class="math notranslate nohighlight">\(n=30\)</span> objects and embed into <span class="math notranslate nohighlight">\(d=2\)</span>
dimensions. The human noise model used in the Salmon experiments is
generated from the responses collected during NEXT’s experiment. The
are the same experiment, up to different responses (NEXT
actually runs crowdsourcing experiments; Salmon’s noise model is
generated from those responses).</p>
</dd>
<dt class="label" id="accuracy"><span class="brackets"><a class="fn-backref" href="#id10">7</a></span></dt>
<dd><p>Astute observers might notice that the accuracy doesn’t perform
well when directly compared with NEXT’s results. However, the
developed noise model doesn’t exactly mirror the human
responses; it’s about 1.5% less accurate (shown below).
However, the nearest neighbor accuracy is a measure of the
underlying embedding, and Salmon perform better than the NEXT
results.</p>
</dd>
<dt class="label" id="noise"><span class="brackets"><a class="fn-backref" href="#id6">8</a></span></dt>
<dd><p>Specifically, with a noise model developed the human responses collected
for Fig. 3 of the NEXT paper. <a class="footnote-reference brackets" href="#id16" id="id19">2</a></p>
</dd>
<dt class="label" id="perfect"><span class="brackets"><a class="fn-backref" href="#id12">9</a></span></dt>
<dd><p>“Not quite perfect” means “1D manifold with a constant distance
to the nearest neighbor: an embedding with coordinates <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">0],</span>
<span class="pre">[2,</span> <span class="pre">0],</span> <span class="pre">[3,</span> <span class="pre">0],</span> <span class="pre">...,</span> <span class="pre">[n</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">0]]</span></code>.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="server.html" class="btn btn-neutral float-left" title="Concurrent Users" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../adaptive.html" class="btn btn-neutral float-right" title="Adaptive algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Scott Sievert.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>